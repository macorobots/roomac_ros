<launch>
  <arg name="rosbag" default="lap1-02-08-fixed.bag_filtered" />
  <arg name="rosbag_play_rate" default="1" />

  <param name="use_sim_time" type="bool" value="true" />

  <node pkg="rosbag" type="play" name="player" output="screen" args="--clock -r $(arg rosbag_play_rate) /home/roomac/rosbags/$(arg rosbag)" />

  <param name="robot_description" command="$(find xacro)/xacro $(find roomac_description)/urdf/roomac.xacro" />
  <node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" />

  <include file="$(find roomac_rtabmap)/launch/rtabmap_localization_wheel_odom.launch" />

  <include file="$(find roomac_move_base)/launch/rviz_move_base.launch" />

  <include file="$(find rgbd_launch)/launch/kinect_frames.launch" />

  <include file="$(find roomac_sensor_fusion)/launch/robot_localization.launch" />

  <node pkg="nodelet" type="nodelet" name="nodelet_manager" args="manager" />

  <node pkg="nodelet" type="nodelet" name="nodelet1"
    args="load depth_image_proc/point_cloud_xyz nodelet_manager">
    <remap from="camera_info" to="/camera/depth_registered/camera_info" />
    <remap from="image_rect" to="/camera/depth_registered/image_raw" />
    <remap from="points" to="/camera/depth_registered/points" />
  </node>

  <include file="$(find roomac_move_base)/launch/move_base.launch" />
</launch>